<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>📊 Retail Analytics Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500&display=swap" rel="stylesheet">

    <style>
        body {
            background: url('https://media.istockphoto.com/id/1273237907/photo/business-financial-concept-with-double-exposure-stock-market-up-trading-line.jpg?s=612x612&w=0&k=20&c=7IcMaykcjV01Qgy84VQyxEdLcdoC3WNCfG9pupUd-SA=') no-repeat center center fixed;
            background-size: cover;
            font-family: 'Poppins', sans-serif;
            color: white;
        }

        .dashboard-container {
            background: rgba(0, 0, 0, 0.75);
            padding: 30px;
            margin-top: 40px;
            border-radius: 16px;
            box-shadow: 0 0 25px rgba(0, 0, 0, 0.6);
        }

        h2, h4 {
            text-shadow: 0 0 5px rgba(255,255,255,0.6);
        }

        canvas {
            background: rgba(255, 255, 255, 0.06);
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 30px;
            max-height: 220px;
        }

        .nav-buttons a {
            margin: 5px;
        }

        .btn-home {
            background-color: #1d3557;
            border: none;
        }

        .btn-home:hover {
            background-color: #457b9d;
        }
    </style>
</head>
<body>

<div class="container dashboard-container">
    <h2 class="text-center mb-4">📊 Retail Analytics Full Dashboard</h2>

    <div class="text-center nav-buttons mb-4">
        <a href="/home" class="btn btn-light btn-sm">🏠 Home</a>
        <a href="/upload" class="btn btn-light btn-sm">📤 Upload</a>
        <a href="/search" class="btn btn-light btn-sm">🔍 Search</a>
        <a href="/datapull10" class="btn btn-light btn-sm">📄 HSHD_NUM 10</a>
        <a href="/basket" class="btn btn-light btn-sm">🧺 Basket</a>
        <a href="/churn" class="btn btn-light btn-sm">💔 Churn</a>
    </div>

    <h4>📈 Engagement Over Time</h4>
    <canvas id="lineChart"></canvas>

    <h4 class="mt-5">👨‍👩‍👧‍👦 Demographics by Income</h4>
    <canvas id="incomeChart"></canvas>

    <h4 class="mt-5">🏷️ Private vs National Brand Spend</h4>
    <canvas id="brandChart"></canvas>

    <h4 class="mt-5">🌦️ Seasonal Spend Trends</h4>
    <canvas id="seasonChart"></canvas>

    <h4 class="mt-5">🧺 Top Purchased Commodities</h4>
    <canvas id="basketChart"></canvas>

    <div class="text-center mt-4">
        <a href="/home" class="btn btn-primary btn-home">🏠 Back to Home</a>
    </div>
</div>

<!-- ChartJS Data Scripts -->
<script>
    const lineData = JSON.parse(`{{ line_data | tojson | safe }}`);
    const incomeData = JSON.parse(`{{ income_data | tojson | safe }}`);
    const brandData = JSON.parse(`{{ brand_data | tojson | safe }}`);
    const seasonData = JSON.parse(`{{ season_data | tojson | safe }}`);
    const basketData = JSON.parse(`{{ basket_data | tojson | safe }}`);


    new Chart(document.getElementById('lineChart'), {
        type: 'line',
        data: {
            labels: lineData.labels,
            datasets: [{
                label: 'Total Spend',
                data: lineData.values,
                borderColor: '#00d4ff',
                tension: 0.3,
                pointRadius: 2
            }]
        },
        options: {
            plugins: { legend: { labels: { color: 'white' } } },
            scales: {
                x: { ticks: { color: 'white', maxRotation: 45, minRotation: 45 } },
                y: { ticks: { color: 'white' } }
            }
        }
    });

    new Chart(document.getElementById('incomeChart'), {
        type: 'pie',
        data: {
            labels: incomeData.labels,
            datasets: [{
                data: incomeData.values,
                backgroundColor: ['#0077b6', '#90e0ef', '#00b4d8', '#caf0f8', '#48cae4']
            }]
        },
        options: {
            plugins: { legend: { position: 'bottom', labels: { color: 'white' } } }
        }
    });

    new Chart(document.getElementById('brandChart'), {
        type: 'pie',
        data: {
            labels: brandData.labels,
            datasets: [{
                data: brandData.values,
                backgroundColor: ['#ffafcc', '#cdb4db']
            }]
        },
        options: {
            plugins: { legend: { position: 'bottom', labels: { color: 'white' } } }
        }
    });

    new Chart(document.getElementById('seasonChart'), {
        type: 'line',
        data: {
            labels: seasonData.labels,
            datasets: [{
                label: 'Spend by Month',
                data: seasonData.values,
                borderColor: '#fb8500',
                tension: 0.3,
                pointRadius: 2
            }]
        },
        options: {
            plugins: { legend: { labels: { color: 'white' } } },
            scales: {
                x: { ticks: { color: 'white', maxRotation: 45, minRotation: 45 } },
                y: { ticks: { color: 'white' } }
            }
        }
    });

    new Chart(document.getElementById('basketChart'), {
        type: 'bar',
        data: {
            labels: basketData.labels,
            datasets: [{
                label: 'Frequency',
                data: basketData.values,
                backgroundColor: '#219ebc'
            }]
        },
        options: {
            plugins: { legend: { display: false } },
            scales: {
                x: { ticks: { color: 'white' } },
                y: { ticks: { color: 'white' } }
            }
        }
    });
</script>

</body>
</html>
